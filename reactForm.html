<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Testing</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
</head>
<body>
	<div id="react-app" class="col-xs-12"></div>
	<script src="https://fb.me/react-0.14.3.js"></script>
	<script src="https://fb.me/react-dom-0.14.3.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
	<script type="text/babel">
  /*
 * Components
 */
  // var pendingItems = [
  //   'Clean the room',
  //   'Get milf',
  //   'Sellout and stuff'
  //   ];

  // var finishedItems = [
  //   'Clean the room',
  //   ];

  var Todo = React.createClass({
  	render: function() {
  		return (
  				<div className="col-xs-10 task" onClick={this.props.onClick}>{this.props.title}</div>
  			);
  	},
  });  

  var Deleter = React.createClass({
  	propTypes:{
  		vouch: React.PropTypes.string
  	},
  	render: function() {
  		return (
  			<a className="col-xs-2" href="#" data-vouch={this.props.vouch} index={this.props.index} onClick={this.props.onClick}>X</a>
  			);
  	},
  });

  var Todos = React.createClass({
  	  propTypes:{
  		vouch: React.PropTypes.string,
  	},
  	getInitialState: function() {
  		return {
  			pendingItems: ['Apple', 'Banana', 'Cranberry'],
  			finishedItems: ['Clean stuff']
  		};
  	},

  	handlePendingClick: function(index) {
  		var items = this.state.pendingItems.filter(function(item, i) {
  			return index !== i;
  		});
  		// this.state.finishedItems.push.this.state.pendingItems[index];
  		var temp = this.state.pendingItems[index];
  		var tempArray = this.state.finishedItems.slice(0);

  		tempArray.push(temp);
  		this.setState({pendingItems: items});
  		this.setState({finishedItems: tempArray});
  	},
  	handleDeleteClick: function(index,e) {
  		if (e.target.dataset.vouch == "pending") {
  			var items = this.state.pendingItems.filter(function(item, i) {
  				return index !== i;
  			});
  			console.log("Item removed from pending");
  			this.setState({pendingItems: items});
  		};

  		if (e.target.dataset.vouch == "finished") {
  			var items = this.state.finishedItems.filter(function(item, i) {
  				return index !== i;
  			});
  			console.log("Item removed from finished");
  			this.setState({finishedItems: items});
  		};
  	},
  	handleFinishedClick: function(index) {
  		var items = this.state.finishedItems.filter(function(item, i) {
  			return index !== i;
  		});
  		// this.state.finishedItems.push.this.state.pendingItems[index];
  		var temp = this.state.finishedItems[index];
  		var tempArray = this.state.pendingItems.slice(0);

  		tempArray.push(temp);
  		this.setState({finishedItems: items});
  		this.setState({pendingItems: tempArray});
  	},
  	render: function() {
  		return (
  			<div className="col-xs-6">
  				<div className="col-xs-6">
  					<h1>Pending items</h1>
  					{this.state.pendingItems.map(function(item, i) {
  						var boundClick = this.handlePendingClick.bind(this, i);
  						var deleteClick = this.handleDeleteClick.bind(this, i);
  						return (
  							<div key={'cp'+i} className="col-xs-12 list">
  								<Todo onClick={boundClick} key={i} title={item} ref={'itemP' + i} />
  								<Deleter index={i} vouch="pending" key={'dp'+i} onClick={deleteClick} />
  							</div>
  							);
  					}, this)}
  				</div>
  				<div className="col-xs-6">
  					<h1>Finished items</h1>
  					{this.state.finishedItems.map(function(item, i) {
  						var boundClick = this.handleFinishedClick.bind(this, i);
  						var deleteClick = this.handleDeleteClick.bind(this, i);
  						return (
  							<div key={'cf'+i} className="col-xs-12 list">
  							<Todo onClick={boundClick} key={i} title={item} ref={'itemF' + i} />
  							<Deleter index={i} vouch="finished" key={'df'+i} onClick={deleteClick} />
  							</div>
  							);
  					}, this)}
  				</div>
  			</div>
  			);
  	}
  });

ReactDOM.render(<Todos className="col-xs-6"/>, document.getElementById('react-app'));
</script>
<style>
	.task{
		cursor: pointer;
		line-height: 40px;
	}

	.list{
		border:1px solid gray;
		margin-bottom: 5px;
	}
</style>
</body>
</html>
